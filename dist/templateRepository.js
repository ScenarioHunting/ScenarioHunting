var templateRepo;(()=>{"use strict";var e={468:(e,t,n)=>{n.r(t),n.d(t,{getTemplateRepository:()=>o,createOrUpdateSampleTemplates:()=>l});var i=function(e,t,n,i){return new(n||(n=Promise))((function(a,o){function l(e){try{s(i.next(e))}catch(e){o(e)}}function r(e){try{s(i.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,r)}s((i=i.apply(e,t||[])).next())}))};class a{getAllTemplateNames(){return i(this,void 0,void 0,(function*(){return(yield this.findAllTemplateWidgets()).map((e=>(console.log("template:"+e.metadata[miro.getClientId()].templateName+"found!"),e.metadata[miro.getClientId()].templateName)))}))}removeTemplate(e){return i(this,void 0,void 0,(function*(){(yield this.findWidgetByTemplateName(e)).forEach((e=>i(this,void 0,void 0,(function*(){return yield miro.board.widgets.deleteById(e.id)}))))}))}createOrReplaceTemplate(e){return i(this,void 0,void 0,(function*(){console.log("createOrReplaceTemplate:"),console.log("finding widget for template:",e.templateName);var t=yield this.findWidgetByTemplateName(e.templateName);if(console.log(`${t.length} widgets found for template with name: ${e.templateName}`),0==t.length){console.log("Creating template:",e);const t=yield miro.board.viewport.get();yield miro.board.widgets.create({type:"TEXT",text:e.contentTemplate,metadata:{[miro.getClientId()]:e},capabilities:{editable:!1},style:{textAlign:"l"},x:t.x-200,y:t.y-200}),console.log(`template: ${e.templateName} is created successfully.`)}else{console.log("Updating template:",e);var n=t[0];n.metadata[miro.getClientId()]=e,yield miro.board.widgets.update(n),console.log(`template:${e.templateName} is updated successfully.`)}}))}findAllTemplateWidgets(){return i(this,void 0,void 0,(function*(){var e=(yield miro.board.widgets.get()).filter((e=>"STICKER"==e.type&&e.text.includes("using")));return console.log("# of widgets contain using in their text:",e.length),(yield miro.board.widgets.get()).filter((e=>e.metadata&&e.metadata["3074457349056199734"]&&e.metadata["3074457349056199734"]&&e.metadata["3074457349056199734"].templateName))}))}findWidgetByTemplateName(e){return i(this,void 0,void 0,(function*(){return(yield this.findAllTemplateWidgets()).filter((t=>t.metadata[miro.getClientId()].templateName==e))}))}getTemplateByName(e){return i(this,void 0,void 0,(function*(){var t=yield this.findWidgetByTemplateName(e);if(0==t.length)throw new Error("Widget not found for template:"+e);console.log("Widgets found:",t);var n=t[0].metadata[miro.getClientId()];return console.log("Corresponding metadata:",t[0].metadata[miro.getClientId()]),console.log("Corresponding template:",n),n}))}}function o(){return i(this,void 0,void 0,(function*(){return new a}))}function l(){return i(this,void 0,void 0,(function*(){var e=new a;yield function(e){return i(this,void 0,void 0,(function*(){const t=[{fileNameTemplate:"{{scenario}}",fileExtension:"cs",contentTemplate:'using StoryTest;\nusing Vlerx.Es.Messaging;\nusing Vlerx.Es.Persistence;\nusing Vlerx.SampleContracts.{{sut}};\nusing Vlerx.{{context}}.{{sut}};\nusing Vlerx.{{context}}.{{sut}}.Commands;\nusing Vlerx.{{context}}.Tests.StoryTests;\nusing Xunit;\n\nnamespace {{context}}.Tests\n{\n    {{#* inline "callConstructor"}}\n    new {{title}}({{#each properties}}"{{example}}"{{#skipLast}},{{/skipLast}}{{/each}}){{/inline}}\n\n    public class {{scenario}} : IStorySpecification\n    {\n        public IDomainEvent[] Given\n        => new IDomainEvent[]{\n    {{#each givens}}\n        {{> callConstructor .}},\n    {{/each}}\n        };\n        public ICommand When\n        => {{> callConstructor when}};\n        public IDomainEvent[] Then\n        => new IDomainEvent[]{\n    {{#each thens}}\n        {{> callConstructor .}},\n    {{/each}}\n        };\n\n        public string Sut { get; } = nameof({{sut}});\n\n        [Fact]\n        public void Run()\n        => TestAdapter.Test(this\n                , setupUseCases: eventStore =>\n                        new[] {\n                        new {{sut}}UseCases(new Repository<{{sut}}.State>(eventStore))\n                        });\n    }\n}',templateName:"sample-template"},{fileNameTemplate:"{{scenario}}2",fileExtension:"cs",contentTemplate:'using StoryTest;\nusing Vlerx.Es.Messaging;\nusing Vlerx.Es.Persistence;\nusing Vlerx.SampleContracts.{{sut}};\nusing Vlerx.{{context}}.{{sut}};\nusing Vlerx.{{context}}.{{sut}}.Commands;\nusing Vlerx.{{context}}.Tests.StoryTests;\nusing Xunit;\n\nnamespace {{context}}.Tests\n{\n    {{#* inline "callConstructor"}}\n    new {{title}}({{#each properties}}"{{example}}"{{#skipLast}},{{/skipLast}}{{/each}}){{/inline}}\n\n    public class {{scenario}} : IStorySpecification\n    {\n        public IDomainEvent[] Given\n        => new IDomainEvent[]{\n    {{#each givens}}\n        {{> callConstructor .}},\n    {{/each}}\n        };\n        public ICommand When\n        => {{> callConstructor when}};\n        public IDomainEvent[] Then\n        => new IDomainEvent[]{\n    {{#each thens}}\n        {{> callConstructor .}},\n    {{/each}}\n        };\n\n        public string Sut { get; } = nameof({{sut}});\n\n        [Fact]\n        public void Run()\n        => TestAdapter.Test(this\n                , setupUseCases: eventStore =>\n                        new[] {\n                        new {{sut}}UseCases(new Repository<{{sut}}.State>(eventStore))\n                        });\n    }\n}',templateName:"sample-template2"}];for(var n=0;n<t.length;n++)yield e.createOrReplaceTemplate(t[n])}))}(e)}))}}},t={};function n(i){if(t[i])return t[i].exports;var a=t[i]={id:i,exports:{}};return e[i].call(a.exports,a,a.exports,n),a.exports}n.m=e,n.x=e=>{},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={70:0},t=[[468]],i=e=>{},a=(a,o)=>{for(var l,r,[s,c,u,d]=o,m=0,p=[];m<s.length;m++)r=s[m],n.o(e,r)&&e[r]&&p.push(e[r][0]),e[r]=0;for(l in c)n.o(c,l)&&(n.m[l]=c[l]);for(u&&u(n),a&&a(o);p.length;)p.shift()();return d&&t.push.apply(t,d),i()},o=self.webpackChunktemplateRepo=self.webpackChunktemplateRepo||[];function l(){for(var i,a=0;a<t.length;a++){for(var o=t[a],l=!0,r=1;r<o.length;r++){var s=o[r];0!==e[s]&&(l=!1)}l&&(t.splice(a--,1),i=n(n.s=o[0]))}return 0===t.length&&(n.x(),n.x=e=>{}),i}o.forEach(a.bind(null,0)),o.push=a.bind(null,o.push.bind(o));var r=n.x;n.x=()=>(n.x=r||(e=>{}),(i=l)())})();var i=n.x();templateRepo=i})();